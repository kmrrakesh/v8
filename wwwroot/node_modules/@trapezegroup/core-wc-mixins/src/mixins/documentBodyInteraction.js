import { BrowserPlatform } from '../../../core-js-browser/src/lib/browserPlatform.js';

// @ts-check

/**
 *
 * @param {{ new (): HTMLElement; new (): HTMLElement; prototype: HTMLElement; }} baseClass
 */
export const documentBodyInteraction = baseClass =>
    class extends baseClass {
        /** @inheritdoc */
        constructor() {
            super();

            this.doBodyClick = this.doBodyClick.bind(this);
        }

        /** @inheritdoc */
        connectedCallback() {
            document.body.addEventListener('mousedown', this.doBodyClick);
            if (BrowserPlatform.Desktop) {
                document.body.addEventListener('resize', this.doBodyClick);
            }
            document.body.addEventListener('scroll', this.doBodyClick);

            super.connectedCallback && super.connectedCallback();
        }

        /** @inheritdoc */
        disconnectedCallback() {
            document.body.addEventListener('mousedown', this.doBodyClick);
            document.body.addEventListener('resize', this.doBodyClick);
            document.body.addEventListener('scroll', this.doBodyClick);

            super.disconnectedCallback && super.disconnectedCallback();
        }

        /**
         * Hndles the wndow resize
         * @param {Node|Window} source - the source of the resize
         */
        doBodyClick(event) {
            console.error('doBodyClick should be overridden');
        }
    };
